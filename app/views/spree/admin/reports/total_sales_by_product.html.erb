<% content_for :page_title do %>
  <%= Spree.t(:total_sales_of_each_product) %>
<% end %>

<% content_for :page_actions do %>
  <li>
    <%= link_to_with_icon 'arproduct-left', Spree.t(:back_to_reports_list), spree.admin_reports_url, class: 'button' %>
  </li>
<% end %>

<% content_for :table_filter_title do %>
  <%= Spree.t(:date_range) %>
<% end %>

<% content_for :table_filter do %>
  <%= form_tag spree.total_sales_by_product_admin_reports_path do %>
    <% if supports_store_id? %>
      <div class="select-filter field align-center">
        <%= label_tag nil, Spree.t(:store), class: 'inline' %>
        <%= select_tag :store_id, options_from_collection_for_select(Spree::Store.all, "id", "name", params[:store_id]), prompt: 'All' %>
      </div>
    <% end %>
    <div class="date-range-filter field align-center">
      <%= label_tag nil, Spree.t(:start), class: 'inline' %>
      <%= text_field_tag :completed_at_gt, datepicker_field_value(params[:completed_at_gt]), class: 'datepicker datepicker-from' %>
      <span class="range-divider">
        <i class="fa fa-arproduct-right"></i>
        <%= text_field_tag :completed_at_lt, datepicker_field_value(params[:completed_at_lt]), class: 'datepicker datepicker-to' %>
        <%= label_tag nil, Spree.t(:end), class: 'inline' %>
      </span>
    </div>
    <div class="actions filter-actions">
      <%= button Spree.t(:search), 'search' %>
    </div>
  <% end %>
<% end %>

<div id="total_sales_by_product">
  <table class="admin-report" data-hook="total_sales_by_product">
    <thead>
      <tr>
        <th class="sort" data-sort="name">
          <%= Spree.t(:product_name) %>
        </th>
        <th class="sort" data-sort="sku">
          <%= Spree.t(:product_sku) %>
        </th>
        <th class="sort" data-sort="slug">
          <%= Spree.t(:product_slug) %>
        </th>
        <th class="sort" data-sort="quantity">
          <%= Spree.t(:quantity) %>
        </th>
        <th class="sort" data-sort="sales">
          <%= Spree.t(:sales_total) %>
        </th>
      </tr>
    </thead>
    <tbody class="list">
      <% @products.each do |product| %>
        <tr class="align-center">
          <td class="name">
            <%= link_to "#{product[:name]}", edit_admin_product_path(product) %>
          </td>
          <td class="sku">
            <%= product.sku %>
          </td>
          <td class="slug">
            <%= product[:slug] %>
          </td>
          <td class="quantity">
            <%= product[:quantity] %>
          </td>
          <td class="sales">
            <%= product[:total_price] %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
